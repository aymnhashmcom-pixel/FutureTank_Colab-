<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€“ FutureTank</title>
<style>
body{font-family:Arial;background:#f5f5f5;padding:20px}
.card{background:#fff;padding:20px;border-radius:8px;max-width:500px;margin:auto}
input,button{width:100%;padding:10px;margin:8px 0}
button{background:#2196f3;color:#fff;border:none;border-radius:4px;cursor:pointer}
button:hover{background:#1976d2}
.msg{margin-top:10px;font-weight:bold}
</style>
</head>

<body>
<div class="card">
<h2>ğŸ›’ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h2>

<form id="productForm">
<input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" required>
<input type="number" id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±" required>

<label>ğŸ“· ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)</label>
<input type="file" id="image" accept="image/*" required>

<label>ğŸ¥ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
<input type="file" id="video" accept="video/*">

<button type="submit">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
</form>

<div class="msg" id="msg"></div>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, addDoc, collection } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "futuretank-68c26.firebaseapp.com",
  projectId: "futuretank-68c26",
  storageBucket: "futuretank-68c26.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

document.getElementById("productForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const msg = document.getElementById("msg");
  msg.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...";

  try {
    const name = document.getElementById("name").value;
    const price = Number(document.getElementById("price").value);
    const imageFile = document.getElementById("image").files[0];
    const videoFile = document.getElementById("video").files[0];

    // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)
    const imgRef = ref(storage, `products/images/${Date.now()}_${imageFile.name}`);
    await uploadBytes(imgRef, imageFile);
    const imageURL = await getDownloadURL(imgRef);

    // Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    let videoURL = "";
    if (videoFile) {
      const vidRef = ref(storage, `products/videos/${Date.now()}_${videoFile.name}`);
      await uploadBytes(vidRef, videoFile);
      videoURL = await getDownloadURL(vidRef);
    }

    // Ø­ÙØ¸ ÙÙŠ Firestore
    await addDoc(collection(db, "products"), {
      name,
      price,
      image: imageURL,
      video: videoURL,
      createdAt: new Date()
    });

    msg.innerText = "âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­";
    e.target.reset();

  } catch (err) {
    console.error(err);
    msg.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø¶Ø§ÙØ©";
  }
});
</script>
</body>
</html>
