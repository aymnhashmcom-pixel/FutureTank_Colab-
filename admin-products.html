<h2>๐ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</h2>

<div class="card">
  <h3>โ ุฅุถุงูุฉ ููุชุฌ</h3>

  <input type="text" id="productName" placeholder="ุงุณู ุงูููุชุฌ" required>
  <input type="number" id="productPrice" placeholder="ุงูุณุนุฑ ุจุงูุฌููู" required>

  <input type="text" id="productImage"
         placeholder="ุฑุงุจุท ุตูุฑุฉ ูุจุงุดุฑ (jpg / png) โ ุฅุฌุจุงุฑู">

  <input type="text" id="productVideo"
         placeholder="ุฑุงุจุท ููุฏูู (ุงุฎุชูุงุฑู โ YouTube / MP4)">

  <button onclick="addProduct()">โ ุฅุถุงูุฉ ุงูููุชุฌ</button>

  <p id="productStatus"></p>
</div>

<hr>

<h3>๐ฆ ุงูููุชุฌุงุช ุงูุญุงููุฉ</h3>
<div id="productsList"></div>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
  firebase.initializeApp({
    apiKey: "AIzaSyBmWKWIPtVjUYXGOF77Zstmz3ROpvKIDog",
    authDomain: "futuretank-68c26.firebaseapp.com",
    projectId: "futuretank-68c26"
  });

  const db = firebase.firestore();

  function isValidImageUrl(url) {
    return /^https?:\/\/.+\.(jpg|jpeg|png|webp)$/i.test(url);
  }

  window.addProduct = async function () {
    const name = productName.value.trim();
    const price = Number(productPrice.value);
    const image = productImage.value.trim();
    const video = productVideo.value.trim();
    const status = productStatus;

    if (!name || !price || !image) {
      alert("โ๏ธ ุงูุงุณู + ุงูุณุนุฑ + ุฑุงุจุท ุตูุฑุฉ ูุจุงุดุฑ ูุทููุจูู");
      return;
    }

    if (!isValidImageUrl(image)) {
      alert("โ ุฑุงุจุท ุงูุตูุฑุฉ ูุฌุจ ุฃู ูููู URL ูุจุงุดุฑ ูููุชูู ุจู jpg ุฃู png");
      return;
    }

    status.innerText = "โณ ุฌุงุฑู ุงูุฅุถุงูุฉ...";

    try {
      await db.collection("products").add({
        name,
        price,
        image,
        video,
        createdAt: new Date()
      });

      status.innerText = "โ ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุจูุฌุงุญ";
      productName.value = "";
      productPrice.value = "";
      productImage.value = "";
      productVideo.value = "";

      loadProducts();

    } catch (e) {
      console.error(e);
      status.innerText = "โ ูุดู ุงูุฅุถุงูุฉ";
    }
  };

  async function loadProducts() {
    const container = document.getElementById("productsList");
    container.innerHTML = "";

    const snap = await db.collection("products").orderBy("createdAt", "desc").get();

    snap.forEach(doc => {
      const p = doc.data();
      container.innerHTML += `
        <div class="item">
          <strong>${p.name}</strong> โ ${p.price} ุฌููู
          <br>
          <img src="${p.image}" style="max-width:120px;margin-top:5px">
          <br>
          <button onclick="deleteProduct('${doc.id}')">๐ ุญุฐู</button>
        </div>
      `;
    });
  }

  async function deleteProduct(id) {
    if (!confirm("ุญุฐู ุงูููุชุฌุ")) return;
    await db.collection("products").doc(id).delete();
    loadProducts();
  }

  loadProducts();
  </script>
