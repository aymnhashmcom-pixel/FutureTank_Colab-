<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ğŸ“Š ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ â€” FutureTank</title>
<style>
body{font-family:Tahoma;background:#f4f9ff;margin:20px}
h2{color:#4a90e2}
.container{background:#fff;padding:20px;border-radius:12px}
.filters{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px}
input,button,select{padding:8px}
button{cursor:pointer;border:0;border-radius:6px;background:#4a90e2;color:#fff}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin:15px 0}
.card{background:#eef5ff;padding:15px;border-radius:10px;text-align:center}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#eef5ff}
.good{color:green;font-weight:bold}
.bad{color:#d9534f;font-weight:bold}
.print{background:#28a745}
</style>
</head>
<body>
<h2>ğŸ“Š ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ â€” FutureTank</h2>
<div class="container"><div class="filters">
  <label>Ù…Ù† ØªØ§Ø±ÙŠØ® <input type="date" id="from"></label>
  <label>Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ® <input type="date" id="to"></label>
  <button onclick="loadReports()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
  <button class="print" onclick="window.print()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø©</button>
</div><div class="stats">
  <div class="card">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù‚ÙˆØ¯<br><b id="total">0</b></div>
  <div class="card">Ø²ÙŠØ§Ø±Ø§Øª Ù‚Ø§Ø¯Ù…Ø©<br><b id="upcoming">0</b></div>
  <div class="card">Ø²ÙŠØ§Ø±Ø§Øª Ù…ØªØ£Ø®Ø±Ø©<br><b id="late">0</b></div>
  <div class="card">ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°<br><b id="done">0</b></div>
  <div class="card">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ­ØµÙŠÙ„ (Ø¬Ù†ÙŠÙ‡)<br><b id="revenue">0</b></div>
</div><table>
<thead>
<tr>
  <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
  <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
  <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
  <th>Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th>
  <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
  <th>Ø§Ù„ØªÙƒÙ„ÙØ©</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table></div><script>
const db = JSON.parse(localStorage.getItem('ft_db')||'{}');
const contracts = db.contracts || [];

function loadReports(){
  const from = document.getElementById('from').value;
  const to = document.getElementById('to').value;
  const f = from ? new Date(from) : null;
  const t = to ? new Date(to) : null;

  let total=0, upcoming=0, late=0, done=0, revenue=0;
  const body = document.getElementById('rows');
  body.innerHTML='';

  const today = new Date();

  contracts.forEach(c=>{
    const d = new Date(c.nextVisit);
    if((f && d < f) || (t && d > t)) return;

    total++;
    revenue += Number(c.cost||0);
    if(c.status==='ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°') done++;
    else if(d < today) late++;
    else upcoming++;

    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${c.client}</td>
      <td>${c.phone}</td>
      <td>${c.service}</td>
      <td>${c.nextVisit}</td>
      <td class="${c.status==='ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°'?'good':'bad'}">${c.status}</td>
      <td>${c.cost} Ø¬Ù†ÙŠÙ‡</td>
    `;
    body.appendChild(tr);
  });

  document.getElementById('total').innerText = total;
  document.getElementById('upcoming').innerText = upcoming;
  document.getElementById('late').innerText = late;
  document.getElementById('done').innerText = done;
  document.getElementById('revenue').innerText = revenue;
}

loadReports();
</script></body>
</html>
