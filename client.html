<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ğŸ”‘ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ â€” FutureTank</title>
<style>
body{
  font-family:Tahoma;
  background:#f4f9ff;
  padding:20px
}
.box{
  max-width:500px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,.1)
}
input,button{
  width:100%;
  padding:10px;
  margin-top:10px;
  font-size:15px
}
button{
  background:#007bff;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer
}
.data{
  margin-top:20px;
  background:#f9fbff;
  padding:15px;
  border-radius:8px
}
.renew{
  background:#4caf50;
  margin-top:15px
}
.hidden{display:none}
</style>
</head>

<body>

<div class="box">
<h2>ğŸ”‘ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
<p>Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„</p>

<input id="code" placeholder="Ù…Ø«Ø§Ù„: FT-1025">
<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>

<div id="result" class="data hidden"></div>
</div>

<script>
const WHATSAPP = "201150402031";

function login(){
  const code = document.getElementById("code").value.trim();
  const db = JSON.parse(localStorage.getItem("ft_db")||"{}");
  const contracts = db.contracts || [];

  const c = contracts.find(x => x.code === code);
  if(!c){
    alert("âŒ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­");
    return;
  }

  const box = document.getElementById("result");
  box.classList.remove("hidden");

  const today = new Date();
  const renewDate = new Date(c.renewDate);
  const showRenew = renewDate.getMonth() === 0; // ÙŠÙ†Ø§ÙŠØ±

  box.innerHTML = `
    <h3>ğŸ‘¤ ${c.client}</h3>
    <p>ğŸ§° Ø§Ù„Ø®Ø¯Ù…Ø©: ${c.service}</p>
    <p>ğŸ“… Ø¢Ø®Ø± Ø²ÙŠØ§Ø±Ø©: ${c.lastVisit}</p>
    <p>ğŸ“… Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: ${c.nextVisit}</p>
    <p>ğŸ“„ ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹Ø§Ù‚Ø¯: ${c.startDate}</p>
    <p>ğŸ” ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯: ${c.renewDate}</p>
    <p>ğŸ’° Ø§Ù„ØªÙƒÙ„ÙØ©: ${c.cost} Ø¬Ù†ÙŠÙ‡</p>

    ${showRenew ? `
    <button class="renew"
      onclick="renew('${c.client}','${c.service}')">
      ğŸ” ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯
    </button>` : ""}
  `;
}

function renew(client,service){
  const msg = `Ø·Ù„Ø¨ ØªØ¬Ø¯ÙŠØ¯ ØªØ¹Ø§Ù‚Ø¯%nØ§Ù„Ø¹Ù…ÙŠÙ„: ${client}%nØ§Ù„Ø®Ø¯Ù…Ø©: ${service}`;
  window.open(
    `https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`
  );
}
</script>

</body>
</html>
