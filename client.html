<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ğŸ” Ø¨ÙˆØ§Ø¨Ø© Ø¹Ù…Ù„Ø§Ø¡ FutureTank</title>

<style>
body{
  font-family:Tahoma;
  background:#f4f9ff;
  padding:20px
}
.card{
  background:#fff;
  max-width:600px;
  margin:auto;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,.15)
}
h2{text-align:center;color:#0077b6}
input,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:15px
}
button{
  background:#0077b6;
  color:#fff;
  border:none;
  cursor:pointer
}
.renew{background:#ff9800}
.whatsapp{background:#25d366}
.info{
  background:#f1f7ff;
  padding:15px;
  border-radius:6px;
  margin-top:15px
}
.hidden{display:none}
</style>
</head>

<body>

<div class="card">

<h2>ğŸ” Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>

<div id="loginBox">
  <input id="loginInput" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="clientBox" class="hidden">
  <h3>ğŸ‘¤ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>

  <div class="info">
    <p><b>Ø§Ù„Ø§Ø³Ù…:</b> <span id="cName"></span></p>
    <p><b>Ø§Ù„Ù‡Ø§ØªÙ:</b> <span id="cPhone"></span></p>
    <p><b>Ø§Ù„ØªÙƒÙ„ÙØ©:</b> <span id="cCost"></span> Ø¬Ù†ÙŠÙ‡</p>
    <p><b>Ù…Ø¯Ø© Ø§Ù„ØªØ¹Ø§Ù‚Ø¯:</b> <span id="cStart"></span> â†’ <span id="cEnd"></span></p>
    <p><b>Ø¢Ø®Ø± Ø²ÙŠØ§Ø±Ø©:</b> <span id="cLast"></span></p>
    <p><b>Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©:</b> <span id="cNext"></span></p>
  </div>

  <button class="renew" onclick="renew()">ğŸ”„ ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯</button>

  <button class="whatsapp" onclick="sendWhats()">ğŸ’¬ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
</div>

</div>

<script>
const db = JSON.parse(localStorage.getItem("ft_db") || "{}");
let currentClient = null;

function login(){
  const val = loginInput.value.trim();
  if(!val) return alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯");

  currentClient = db.clients?.find(c =>
    c.phone === val || c.code === val
  );

  if(!currentClient){
    alert("Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
    return;
  }

  loginBox.classList.add("hidden");
  clientBox.classList.remove("hidden");

  cName.textContent = currentClient.name;
  cPhone.textContent = currentClient.phone;
  cCost.textContent = currentClient.cost;
  cStart.textContent = currentClient.start;
  cEnd.textContent = currentClient.end;
  cLast.textContent = currentClient.lastVisit || "-";
  cNext.textContent = currentClient.nextVisit || "-";
}

function renew(){
  if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ØŸ")) return;

  const today = new Date();
  const newStart = today.toISOString().split("T")[0];

  const newEnd = new Date();
  newEnd.setFullYear(newEnd.getFullYear()+1);

  currentClient.start = newStart;
  currentClient.end = newEnd.toISOString().split("T")[0];

  saveDB();

  alert("ØªÙ… ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ Ø¨Ù†Ø¬Ø§Ø­");

  location.href = `contract.html?phone=${currentClient.phone}`;
}

function saveDB(){
  localStorage.setItem("ft_db", JSON.stringify(db));
}

function sendWhats(){
  const msg = `
Ù…Ø±Ø­Ø¨Ø§ FutureTank
Ø£Ù†Ø§ ${currentClient.name}
Ø±Ù‚Ù… ${currentClient.phone}
`;
  window.open(`https://wa.me/201150402031?text=${encodeURIComponent(msg)}`);
}
</script>

</body>
</html>
