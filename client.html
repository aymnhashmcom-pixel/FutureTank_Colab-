<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ğŸ‘¤ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ â€” FutureTank</title>

<style>
body{
  font-family:Tahoma;
  background:#f4f9ff;
  padding:20px
}
.card{
  background:#fff;
  padding:20px;
  max-width:600px;
  margin:auto;
  border-radius:12px;
  box-shadow:0 2px 10px rgba(0,0,0,.1)
}
h2{color:#0d6efd}
.info{
  background:#eef5ff;
  padding:12px;
  border-radius:8px;
  margin:8px 0
}
button,a{
  display:inline-block;
  margin:5px 5px 0 0;
  padding:10px 14px;
  border-radius:6px;
  text-decoration:none;
  border:none;
  cursor:pointer;
  font-size:14px
}
.whatsapp{background:#25d366;color:#fff}
.renew{background:#ff9800;color:#fff}
.notfound{
  background:#ffe0e0;
  padding:15px;
  border-radius:8px;
  color:#b00020
}
</style>
</head>

<body>

<div class="card" id="box"></div>

<script>
const params = new URLSearchParams(location.search);
const code = params.get("code");

const db = JSON.parse(localStorage.getItem("ft_db")||"{}");
const clients = db.clients || [];

const client = clients.find(c=>c.code===code);
const box = document.getElementById("box");

if(!code || !client){
  box.innerHTML = `
    <div class="notfound">
      âŒ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­<br><br>
      Ø¨Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
    </div>
  `;
}else{
  box.innerHTML = `
    <h2>ğŸ‘¤ Ù…Ø±Ø­Ø¨Ù‹Ø§ ${client.name}</h2>

    <div class="info">ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${client.phone}</div>
    <div class="info">ğŸ§° Ø§Ù„Ø®Ø¯Ù…Ø©: ${client.service}</div>
    <div class="info">ğŸ“… Ø¢Ø®Ø± Ø²ÙŠØ§Ø±Ø©: ${client.lastVisit || "-"}</div>
    <div class="info">ğŸ“† Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: ${client.nextVisit || "-"}</div>
    <div class="info">ğŸ“„ ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹Ø§Ù‚Ø¯: ${client.contract || "-"}</div>
    <div class="info">ğŸ” Ø´Ù‡Ø± Ø§Ù„ØªØ¬Ø¯ÙŠØ¯: ${client.renew || "-"}</div>

    ${
      client.renew === "ÙŠÙ†Ø§ÙŠØ±"
      ? `<button class="renew" onclick="renew()">ğŸ”„ ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ Ø§Ù„Ø¢Ù†</button>`
      : ``
    }

    <a class="whatsapp"
       href="https://wa.me/201150402031?text=Ø§Ø³ØªÙØ³Ø§Ø±%20Ø¹Ù…ÙŠÙ„%20ÙƒÙˆØ¯:${client.code}"
       target="_blank">
       ğŸ’¬ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
    </a>
  `;
}

function renew(){
  const msg = `
Ø¹Ù…ÙŠÙ„ ÙŠØ±ØºØ¨ ÙÙŠ ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯
Ø§Ù„Ø§Ø³Ù…: ${client.name}
Ø§Ù„ÙƒÙˆØ¯: ${client.code}
Ø§Ù„Ø®Ø¯Ù…Ø©: ${client.service}
`;
  window.open(
    "https://wa.me/201150402031?text="+encodeURIComponent(msg),
    "_blank"
  );
}
</script>

</body>
</html>
