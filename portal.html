<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>بوابة العملاء - FutureTank</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>بوابة العملاء</h2>

<input id="phone" placeholder="رقم الهاتف">
<button onclick="getContract()">عرض التعاقد</button>

<pre id="result"></pre>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxm2p2UAJrEUG2sNi8vbkKBGsZKS4joiEEmIV8Skl6iAgZSgFzm5GP_n-RPRsDQCJJp/exec";

function getContract() {
  const phone = document.getElementById("phone").value.trim();
  const result = document.getElementById("result");

  if (!phone) {
    result.textContent = "❌ من فضلك أدخل رقم الهاتف";
    return;
  }

  result.textContent = "⏳ جاري البحث...";

  // ✅ GET فقط — بدون POST — بدون body
  fetch(API_URL + "?phone=" + encodeURIComponent(phone))
    .then(res => res.json())
    .then(data => {
      if (data.success && data.contract) {
        result.textContent =
`الاسم: ${data.contract.name}
الهاتف: ${data.contract.phone}
العنوان: ${data.contract.address}
الخدمة: ${data.contract.service}
مدة التعاقد: ${data.contract.duration}
التكلفة: ${data.contract.cost}
آخر زيارة: ${data.contract.lastVisit}
الزيارة القادمة: ${data.contract.nextVisit}`;
      } else {
        result.textContent = "❌ لا يوجد تعاقد مسجل";
      }
    })
    .catch(() => {
      result.textContent = "❌ خطأ اتصال بالخادم";
    });
}
</script>

</body>
</html>
