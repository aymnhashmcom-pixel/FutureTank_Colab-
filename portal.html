<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ | Future Tank</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<header class="main-header">
  <h1>ğŸ’§ Future Tank</h1>
  <p>Ù†Ù‚Ø§Ø¡ Ø§Ù„Ù…ÙŠØ§Ù‡ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ù‡Ù†Ø§</p>
</header>

<section class="portal-container">

  <h2>ğŸ” Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯</h2>

  <input
    type="text"
    id="phone"
    placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
    inputmode="numeric"
  >

  <button onclick="searchClient()">Ø¨Ø­Ø«</button>

  <div id="result" class="client-data hidden"></div>

</section>

<footer class="main-footer">
  Â© Future Tank â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
</footer>

<script>
/* ===============================
   API CONFIG
================================ */
const API_URL =
  "https://script.google.com/macros/s/AKfycbwFU-0YAoqGHyZnHNOQwimoHzzJ6EqX8D-vWiY2DsL8E---HDxUkgNu3tyQ15itWJrd/exec";

const WHATSAPP = "201150402031";

/* ===============================
   SEARCH CLIENT
================================ */
function searchClient() {

  const phoneInput = document.getElementById("phone");
  const phone = phoneInput.value.trim();
  const result = document.getElementById("result");

  if (!phone) {
    alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");
    return;
  }

  result.classList.remove("hidden");
  result.innerHTML = "ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...";

  fetch(API_URL + "?phone=" + encodeURIComponent(phone))
    .then(res => res.json())
    .then(data => {

      if (!data || data.error) {
        result.innerHTML = "âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ¹Ø§Ù‚Ø¯ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…";
        return;
      }

      const msg = `
Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…
Ø£Ø±ØºØ¨ ÙÙŠ ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯
Ø§Ù„Ø§Ø³Ù…: ${data.name}
Ø§Ù„Ù‡Ø§ØªÙ: ${data.phone}
Ø§Ù„Ø®Ø¯Ù…Ø©: ${data.service}
      `;

      result.innerHTML = `
        <div class="data-row"><span>Ø§Ù„Ø§Ø³Ù…</span><span>${safe(data.name)}</span></div>
        <div class="data-row"><span>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span><span>${safe(data.phone)}</span></div>
        <div class="data-row"><span>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</span><span>${safe(data.address)}</span></div>
        <div class="data-row"><span>Ø§Ù„Ø®Ø¯Ù…Ø©</span><span>${safe(data.service)}</span></div>
        <div class="data-row"><span>Ù…Ø¯Ø© Ø§Ù„ØªØ¹Ø§Ù‚Ø¯</span><span>${safe(data.contract_months)} Ø´Ù‡Ø±</span></div>
        <div class="data-row"><span>Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</span><span>${safe(data.visits)}</span></div>
        <div class="data-row"><span>Ø§Ù„ØªÙƒÙ„ÙØ©</span><span>${safe(data.cost)} Ø¬Ù†ÙŠÙ‡</span></div>
        <div class="data-row"><span>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹Ø§Ù‚Ø¯</span><span>${format(data.contract_date)}</span></div>
        <div class="data-row"><span>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</span><span>${format(data.end_date)}</span></div>
        <div class="data-row"><span>Ø¢Ø®Ø± Ø²ÙŠØ§Ø±Ø©</span><span>${format(data.last_visit)}</span></div>
        <div class="data-row"><span>Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</span><span>${format(data.next_visit)}</span></div>
        <div class="data-row"><span>â³ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</span><span>${safe(data.remaining_days)} ÙŠÙˆÙ…</span></div>

        <a class="renew-btn"
           target="_blank"
           href="https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}">
           ğŸ” ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
        </a>
      `;
    })
    .catch(() => {
      result.innerHTML = "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„";
    });
}

/* ===============================
   HELPERS
================================ */
function format(d) {
  if (!d) return "â€”";
  return new Date(d).toLocaleDateString("ar-EG");
}

function safe(v) {
  return v ? v : "â€”";
}
</script>

</body>
</html>
