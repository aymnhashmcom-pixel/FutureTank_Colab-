<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ğŸ“‹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯</title>
<link rel="stylesheet" href="styles.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
.contract {
  border: 1px solid #ddd;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 8px;
}
.badge {
  padding: 3px 8px;
  border-radius: 6px;
  font-size: 12px;
  color: #fff;
}
.new { background:#4CAF50; }
.renew { background:#2196F3; }
.actions a, .actions button {
  margin-right: 8px;
}
</style>
</head>

<body>

<h2>ğŸ“‹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯</h2>

<div id="contracts"></div>

<script>
// Firebase config (Ù†ÙØ³ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹)
firebase.initializeApp({
  apiKey: "AIzaSyBmWKWIPtVjUYXGOF77Zstmz3ROpvKIDog",
  authDomain: "futuretank-68c26.firebaseapp.com",
  projectId: "futuretank-68c26"
});

const db = firebase.firestore();

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù‚ÙˆØ¯
db.collection("contracts")
.orderBy("createdAt", "desc")
.onSnapshot(snapshot => {
  const box = document.getElementById("contracts");
  box.innerHTML = "";

  if (snapshot.empty) {
    box.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚ÙˆØ¯ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>";
    return;
  }

  snapshot.forEach(doc => {
    const c = doc.data();
    const type = c.type === "renew" ? "ØªØ¬Ø¯ÙŠØ¯" : "ØªØ¹Ø§Ù‚Ø¯ Ø¬Ø¯ÙŠØ¯";
    const badgeClass = c.type === "renew" ? "renew" : "new";

    box.innerHTML += `
      <div class="contract">
        <b>${c.clientName || "â€”"}</b>
        <span class="badge ${badgeClass}">${type}</span><br><br>

        ğŸ“ ${c.clientPhone || "â€”"}<br>
        ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${c.createdAt?.toDate().toLocaleDateString() || "â€”"}<br>

        <div class="actions" style="margin-top:10px;">
          <a target="_blank"
             href="https://wa.me/20${c.clientPhone}?text=Ø¨Ø®ØµÙˆØµ Ø¹Ù‚Ø¯ FutureTank">
             ğŸ’¬ ÙˆØ§ØªØ³Ø§Ø¨
          </a>

          <button onclick="deleteContract('${doc.id}')">
            ğŸ—‘ Ø­Ø°Ù
          </button>
        </div>
      </div>
    `;
  });
});

// Ø­Ø°Ù Ø¹Ù‚Ø¯
function deleteContract(id) {
  if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ØŸ")) return;
  db.collection("contracts").doc(id).delete();
}
</script>

</body>
</html>
