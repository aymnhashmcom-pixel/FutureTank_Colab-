<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ÙØ±ÙŠÙ‚ â€” FutureTank</title>
<style>
body{font-family:Tahoma;background:#f4f9ff;margin:20px}
h2{color:#2c6ecb}
table{width:100%;border-collapse:collapse;background:#fff;margin-top:20px}
th,td{border:1px solid #ddd;padding:10px;text-align:center}
th{background:#eef5ff}
button{padding:6px 10px;cursor:pointer}
.badge{background:#ffefc1;padding:4px 8px;border-radius:6px}
</style>
</head>

<body>

<h2>ğŸ‘·â€â™‚ï¸ Ù„ÙˆØ­Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª â€” FutureTank</h2>
<p class="badge">Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ø®Ù„Ø§Ù„ 7 Ø£ÙŠØ§Ù…</p>

<table>
<thead>
<tr>
<th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
<th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
<th>Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th>
<th>Ø§Ù„ØªÙƒÙ„ÙØ©</th>
<th>ØªÙ†ÙÙŠØ°</th>
</tr>
</thead>
<tbody id="teamBody"></tbody>
</table>

<script>
const KEY = "ft_contracts";

function load() {
  return JSON.parse(localStorage.getItem(KEY) || "[]");
}

function save(d) {
  localStorage.setItem(KEY, JSON.stringify(d));
}

function done(id) {
  const data = load();
  const c = data.find(x => x.id === id);
  if (!c) return;

  const today = new Date();
  c.lastVisit = today.toISOString().split("T")[0];

  const next = new Date(today);
  next.setDate(today.getDate() + c.cycle);
  c.nextVisit = next.toISOString().split("T")[0];

  save(data);
  render();
}

function render() {
  const body = document.getElementById("teamBody");
  body.innerHTML = "";

  const today = new Date();
  load().forEach(c => {
    const visit = new Date(c.nextVisit);
    const diff = (visit - today) / (1000*60*60*24);

    if (diff <= 7 && diff >= 0) {
      body.innerHTML += `
<tr>
<td>${c.client}</td>
<td>${c.service}</td>
<td>${c.nextVisit}</td>
<td>${c.cost} Ø¬Ù†ÙŠÙ‡</td>
<td><button onclick="done(${c.id})">âœ” ØªÙ…</button></td>
</tr>`;
    }
  });

  if (!body.innerHTML) {
    body.innerHTML = `<tr><td colspan="5">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø²ÙŠØ§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</td></tr>`;
  }
}

render();
</script>

</body>
</html>
