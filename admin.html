<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzg1RYvL_L56L--cFyLGi34JcGoOkUVu3iYFM8FLSDpu3t-p7FWVX8Le-TQGdVrfcIB/exec";

function saveContract() {
  const form = new URLSearchParams();
  form.append("action", "add");
  form.append("name", name.value);
  form.append("phone", phone.value);
  form.append("address", address.value);
  form.append("service", service.value);
  form.append("duration", duration.value);
  form.append("cost", cost.value);
  form.append("lastVisit", lastVisit.value);
  form.append("nextVisit", nextVisit.value);

  fetch(API_URL, {
    method: "POST",
    body: form
  })
    .then(r => r.json())
    .then(res => {
      msg.innerText = res.success ? "✅ تم حفظ التعاقد" : "❌ فشل الحفظ";
    })
    .catch(() => msg.innerText = "❌ خطأ اتصال");
}
</script>
