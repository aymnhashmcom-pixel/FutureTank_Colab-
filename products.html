<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ù†ØªØ¬Ø§Øª FutureTank</title>
<link rel="stylesheet" href="styles.css">

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* Firebase Config */
const firebaseConfig = {
  apiKey: "AIzaSyBmWKWIPtVjUYXGOF77Zstmz3ROpvKIDog",
  authDomain: "futuretank-68c26.firebaseapp.com",
  projectId: "futuretank-68c26"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const productsBox = document.getElementById("products");

/* ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
async function loadProducts() {
  const snapshot = await getDocs(collection(db, "products"));
  productsBox.innerHTML = "";
  snapshot.forEach(doc => {
    const p = doc.data();
    productsBox.innerHTML += `
      <div class="card">
        <h3>${p.name}</h3>
        <p class="price">${p.price} Ø¬Ù†ÙŠÙ‡</p>
        <button onclick="openForm('${p.name}', ${p.price})">
          Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†
        </button>
      </div>
    `;
  });
}
loadProducts();

/* ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø·Ù„Ø¨ */
window.openForm = (name, price) => {
  document.getElementById("productName").value = name;
  document.getElementById("productPrice").value = price;
  document.getElementById("popup").style.display = "flex";
};

/* ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ */
window.confirmOrder = async () => {
  const clientName = document.getElementById("clientName").value;
  const phone = document.getElementById("clientPhone").value;
  const product = document.getElementById("productName").value;
  const price = document.getElementById("productPrice").value;

  if (!clientName || !phone) {
    alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„");
    return;
  }

  await addDoc(collection(db, "orders"), {
    type: "product",
    product,
    price,
    name: clientName,
    phone,
    status: "ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨",
    date: new Date()
  });

  window.location.href =
    `https://wa.me/201000000000?text=Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡ Ù…Ù†ØªØ¬:%0A${product}%0AØ§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡%0AØ§Ù„Ø§Ø³Ù…: ${clientName}%0AØ§Ù„Ù‡Ø§ØªÙ: ${phone}`;
};
</script>

<style>
body {
  font-family: Arial;
  background: #f7f7f7;
  padding: 20px;
}
.card {
  background: #fff;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 6px #ddd;
}
.price {
  font-weight: bold;
  margin: 10px 0;
}
button {
  background: #28a745;
  color: #fff;
  border: 0;
  padding: 10px 15px;
  border-radius: 6px;
  cursor: pointer;
}
#popup {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.6);
  align-items: center;
  justify-content: center;
}
.form {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  width: 300px;
}
input {
  width: 100%;
  padding: 8px;
  margin-bottom: 10px;
}
</style>
</head>

<body>

<h2>ğŸ›’ Ù…Ù†ØªØ¬Ø§Øª FutureTank</h2>
<div id="products"></div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ù„Ø¨ -->
<div id="popup">
  <div class="form">
    <input id="productName" disabled>
    <input id="productPrice" disabled>
    <input id="clientName" placeholder="Ø§Ø³Ù…Ùƒ">
    <input id="clientPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
    <button onclick="confirmOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
  </div>
</div>

</body>
</html>
