<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª | FutureTank</title>
<style>
body {
  font-family: Arial;
  direction: rtl;
  background: #f5f7fa;
  padding: 20px;
}
.product {
  background: #fff;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
}
button {
  background: #0d6efd;
  color: #fff;
  border: none;
  padding: 10px 16px;
  border-radius: 6px;
  cursor: pointer;
}
button:hover { background:#084298 }
</style>
</head>

<body>

<h2>ğŸ›’ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
<div id="products"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* ğŸ”¹ Ø¥Ø¹Ø¯Ø§Ø¯ Firebase */
const firebaseConfig = {
  apiKey: "AIzaSyBmWKWIPtVjUYXGOF77Zstmz3ROpvKIDog",
  projectId: "futuretank-68c26",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const box = document.getElementById("products");

/* ğŸ”¹ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
const snap = await getDocs(collection(db,"products"));
snap.forEach(docu => {
  const p = docu.data();
  box.innerHTML += `
    <div class="product">
      <h3>${p.name}</h3>
      <p>Ø§Ù„Ø³Ø¹Ø±: ${p.price} Ø¬Ù†ÙŠÙ‡</p>
      <button onclick="buyNow('${p.name}', ${p.price})">
        Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†
      </button>
    </div>
  `;
});

/* ğŸ”¹ ØªÙ†ÙÙŠØ° Ø§Ù„Ø´Ø±Ø§Ø¡ */
window.buyNow = async (name, price) => {
  const phone = prompt("ğŸ“ Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„");
  if (!phone) return;

  // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨
  await addDoc(collection(db,"orders"), {
    product: name,
    price: price,
    phone: phone,
    status: "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",
    createdAt: Date.now()
  });

  // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
  const msgCustomer =
    `âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­\n\n` +
    `ğŸ›’ Ø§Ù„Ù…Ù†ØªØ¬: ${name}\n` +
    `ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡\n\n` +
    `ğŸ“¦ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨: Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°`;

  // Ø±Ø³Ø§Ù„Ø© Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
  const msgAdmin =
    `ğŸ“¥ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\n\n` +
    `ğŸ›’ Ø§Ù„Ù…Ù†ØªØ¬: ${name}\n` +
    `ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡\n` +
    `ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${phone}`;

  // ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„
  window.open(
    `https://wa.me/2${phone}?text=${encodeURIComponent(msgCustomer)}`,
    "_blank"
  );

  // ğŸ”´ Ø±Ù‚Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø¹Ø¯Ù‘Ù„Ù‡ Ù‡Ù†Ø§ ÙÙ‚Ø·)
  window.open(
    `https://wa.me/201001234567?text=${encodeURIComponent(msgAdmin)}`,
    "_blank"
  );
};
</script>

</body>
</html>
