<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ›’ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f9fc;
      direction: rtl;
      padding: 20px;
    }
    h1 { text-align: center; }

    .product {
      background: #fff;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    button {
      background: #4a90e2;
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
    }

    button:hover {
      opacity: 0.9;
    }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ */
    #orderModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: #fff;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      border-radius: 10px;
    }

    input {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
    }

    .actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .cancel {
      background: #aaa;
    }
  </style>
</head>
<body>

<h1>ğŸ›’ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
<div id="products"></div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ù„Ø¨ -->
<div id="orderModal">
  <div class="modal-content">
    <h3 id="selectedProduct"></h3>

    <input id="customerName" placeholder="Ø§Ù„Ø§Ø³Ù…" />
    <input id="customerPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" />
    <input id="customerAddress" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" />

    <div class="actions">
      <button onclick="confirmOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
      <button class="cancel" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<script type="module">
  // ğŸ”¥ Firebase
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, getDocs, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "PUT_YOUR_KEY",
    authDomain: "futuretank-68c26.firebaseapp.com",
    projectId: "futuretank-68c26",
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let currentProduct = null;

  // ğŸ›’ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
  async function loadProducts() {
    const box = document.getElementById("products");
    const snap = await getDocs(collection(db, "products"));

    snap.forEach(doc => {
      const p = doc.data();
      box.innerHTML += `
        <div class="product">
          <h3>${p.name}</h3>
          <p>Ø§Ù„Ø³Ø¹Ø±: ${p.price} Ø¬Ù†ÙŠÙ‡</p>
          <button onclick="openOrder('${p.name}', ${p.price})">
            Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†
          </button>
        </div>
      `;
    });
  }

  loadProducts();

  // ğŸ§¾ ÙØªØ­ Ø§Ù„Ø·Ù„Ø¨
  window.openOrder = (name, price) => {
    currentProduct = { name, price };
    document.getElementById("selectedProduct").innerText =
      `${name} - ${price} Ø¬Ù†ÙŠÙ‡`;
    document.getElementById("orderModal").style.display = "flex";
  };

  // âŒ ØºÙ„Ù‚
  window.closeModal = () => {
    document.getElementById("orderModal").style.display = "none";
  };

  // âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ (Ù…ÙØµÙ„Ù‘Ø­ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§)
  window.confirmOrder = async () => {
    const name = document.getElementById("customerName").value.trim();
    const phone = document.getElementById("customerPhone").value.trim();
    const address = document.getElementById("customerAddress").value.trim();

    if (!name || !phone || !address) {
      alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      return;
    }

    // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨
    await addDoc(collection(db, "orders"), {
      customerName: name,
      phone,
      address,
      product: currentProduct.name,
      price: currentProduct.price,
      status: "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",
      createdAt: serverTimestamp()
    });

    // ÙˆØ§ØªØ³Ø§Ø¨
    const msg = `
Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ ğŸ›’
Ø§Ù„Ù…Ù†ØªØ¬: ${currentProduct.name}
Ø§Ù„Ø³Ø¹Ø±: ${currentProduct.price} Ø¬Ù†ÙŠÙ‡
Ø§Ù„Ø§Ø³Ù…: ${name}
Ø§Ù„Ù‡Ø§ØªÙ: ${phone}
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}
`;
    window.open(
      "https://wa.me/201000000000?text=" + encodeURIComponent(msg),
      "_blank"
    );

    alert("âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
    closeModal();
  };
</script>

</body>
</html>
