<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª | FutureTank</title>

<style>
body{
  font-family: Arial;
  direction: rtl;
  background:#f4f6f9;
  padding:20px;
}
.product{
  background:#fff;
  padding:15px;
  margin-bottom:15px;
  border-radius:8px;
  box-shadow:0 0 5px rgba(0,0,0,.05);
}
button{
  background:#0d6efd;
  color:#fff;
  border:none;
  padding:10px 18px;
  border-radius:6px;
  cursor:pointer;
  font-size:15px;
}
button:hover{
  background:#084298;
}
</style>
</head>

<body>

<h2>ğŸ›’ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
<div id="products"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* Ø¥Ø¹Ø¯Ø§Ø¯ Firebase */
const firebaseConfig = {
  apiKey: "AIzaSyBmWKWIPtVjUYXGOF77Zstmz3ROpvKIDog",
  projectId: "futuretank-68c26"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const box = document.getElementById("products");

/* Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
const snapshot = await getDocs(collection(db,"products"));
snapshot.forEach(docu=>{
  const p = docu.data();
  box.innerHTML += `
    <div class="product">
      <h3>${p.name}</h3>
      <p>Ø§Ù„Ø³Ø¹Ø±: ${p.price} Ø¬Ù†ÙŠÙ‡</p>
      <button onclick="buyNow('${p.name}',${p.price})">
        Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†
      </button>
    </div>
  `;
});

/* ØªÙ†ÙÙŠØ° Ø§Ù„Ø·Ù„Ø¨ */
window.buyNow = async (name, price)=>{
  const phone = prompt("ğŸ“ Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„");
  if(!phone) return;

  // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Firestore
  await addDoc(collection(db,"orders"),{
    product:name,
    price:price,
    phone:phone,
    status:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",
    createdAt:Date.now()
  });

  // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
  const customerMsg =
`âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­

ğŸ›’ Ø§Ù„Ù…Ù†ØªØ¬: ${name}
ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡
ğŸ“¦ Ø§Ù„Ø­Ø§Ù„Ø©: Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°

Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§`;

  // Ø±Ø³Ø§Ù„Ø© Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
  const adminMsg =
`ğŸ“¥ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯

ğŸ›’ Ø§Ù„Ù…Ù†ØªØ¬: ${name}
ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡
ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${phone}
ğŸ“¦ Ø§Ù„Ø­Ø§Ù„Ø©: Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°`;

  // ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„
  window.open(
    `https://wa.me/2${phone}?text=${encodeURIComponent(customerMsg)}`,
    "_blank"
  );

  // ğŸ”´ ÙˆØ§ØªØ³Ø§Ø¨ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ù…ÙØ¹Ø¯Ù„)
  window.open(
    `https://wa.me/201150402031?text=${encodeURIComponent(adminMsg)}`,
    "_blank"
  );
};
</script>

</body>
</html>
