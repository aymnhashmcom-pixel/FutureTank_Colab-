<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ğŸ§° Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª â€” FutureTank</title>

<style>
body{
  font-family:Tahoma;
  background:#f4f9ff;
  padding:20px
}
h2{margin-bottom:15px}
.card{
  background:#fff;
  padding:15px;
  border-radius:10px;
  margin-bottom:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.08)
}
input,textarea,button{
  width:100%;
  padding:8px;
  margin:6px 0;
  font-size:14px
}
button{
  background:#4a90e2;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer
}
button.delete{
  background:#d9534f;
  margin-top:5px
}
img,video{
  max-width:120px;
  display:block;
  margin:5px auto
}
</style>
</head>

<body>

<script src="auth.js"></script>
<script>
requireRole("admin");
</script>

<h2>ğŸ§° Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h2>

<div id="list"></div>

<hr>

<h3>â• Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>

<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©">
<textarea id="desc" placeholder="ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø©"></textarea>
<input id="price" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
<input id="img" type="file" accept="image/*">
<input id="vid" type="file" accept="video/*">

<button onclick="addService()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø©</button>

<script>
const db = JSON.parse(localStorage.getItem("ft_db")||"{}");
db.services = db.services || [];
const list = document.getElementById("list");

function render(){
  list.innerHTML="";
  db.services.forEach((s,i)=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <b>${s.name}</b>
      <p>${s.desc||""}</p>
      <p>${s.price||""}</p>
      ${s.img?`<img src="${s.img}">`:""}
      ${s.video?`<video src="${s.video}" controls></video>`:""}
      <button class="delete" onclick="del(${i})">Ø­Ø°Ù</button>
    `;
    list.appendChild(div);
  });
}

function toBase64(file,cb){
  const r=new FileReader();
  r.onload=()=>cb(r.result);
  r.readAsDataURL(file);
}

function addService(){
  const s={
    name: name.value,
    desc: desc.value,
    price: price.value
  };

  const imgFile = img.files[0];
  const vidFile = vid.files[0];

  if(imgFile){
    toBase64(imgFile,(res)=>{
      s.img=res;
      if(vidFile){
        toBase64(vidFile,(v)=>{
          s.video=v;
          save(s);
        });
      } else save(s);
    });
  } else if(vidFile){
    toBase64(vidFile,(v)=>{
      s.video=v;
      save(s);
    });
  } else save(s);
}

function save(s){
  db.services.push(s);
  localStorage.setItem("ft_db",JSON.stringify(db));
  location.reload();
}

function del(i){
  if(confirm("Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ")){
    db.services.splice(i,1);
    localStorage.setItem("ft_db",JSON.stringify(db));
    render();
  }
}

render();
</script>

</body>
</html>
