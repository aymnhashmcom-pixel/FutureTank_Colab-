<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>๐ฅ ุฅุฏุงุฑุฉ ุงูุนููุงุก</title>
<link rel="stylesheet" href="styles.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>

<h2>๐ฅ ุฅุฏุงุฑุฉ ุงูุนููุงุก</h2>

<div class="card">
<h3>โ ุฅุถุงูุฉ ุนููู</h3>

<input id="name" placeholder="ุงุณู ุงูุนููู" required>
<input id="phone" placeholder="ุฑูู ุงูููุจุงูู" required>
<input id="email" placeholder="ุงูุฅูููู (ุงุฎุชูุงุฑู)">
<input id="price" type="number" placeholder="ูููุฉ ุงูุชุนุงูุฏ">

<label>๐ ุจุฏุงูุฉ ุงูุชุนุงูุฏ</label>
<input id="start" type="date">

<label>๐ ููุงูุฉ ุงูุชุนุงูุฏ</label>
<input id="end" type="date">

<label>๐ ุขุฎุฑ ุฒูุงุฑุฉ</label>
<input id="lastVisit" type="date">

<label>๐ ุงูุฒูุงุฑุฉ ุงููุงุฏูุฉ</label>
<input id="nextVisit" type="date">

<button onclick="addClient()">โ ุฅุถุงูุฉ ุงูุนููู</button>
<p id="status"></p>
</div>

<hr>

<h3>๐ ุงูุนููุงุก ุงูุญุงูููู</h3>
<div id="clients"></div>

<script>
/* Firebase */
firebase.initializeApp({
  apiKey: "PUT_YOUR_KEY",
  authDomain: "futuretank-68c26.firebaseapp.com",
  projectId: "futuretank-68c26"
});

const db = firebase.firestore();

/* ุฅุถุงูุฉ ุนููู */
function addClient() {
  const data = {
    name: name.value.trim(),
    phone: phone.value.trim(),
    email: email.value.trim(),
    price: Number(price.value || 0),
    start: start.value || "",
    end: end.value || "",
    lastVisit: lastVisit.value || "",
    nextVisit: nextVisit.value || "",
    createdAt: new Date()
  };

  if (!data.name || !data.phone) {
    status.innerText = "โ ุงูุงุณู ูุฑูู ุงูููุจุงูู ูุทููุจูู";
    return;
  }

  status.innerText = "โณ ุฌุงุฑู ุงูุฅุถุงูุฉ...";

  db.collection("clients").add(data).then(() => {
    status.innerText = "โ ุชู ุฅุถุงูุฉ ุงูุนููู";
    document.querySelectorAll("input").forEach(i => i.value = "");
  }).catch(() => {
    status.innerText = "โ ูุดู ุงูุฅุถุงูุฉ";
  });
}

/* ุชุญููู ุงูุนููุงุก */
db.collection("clients").orderBy("createdAt","desc").onSnapshot(snap => {
  clients.innerHTML = "";
  snap.forEach(doc => {
    const c = doc.data();
    clients.innerHTML += `
      <div class="item">
        <b>${c.name}</b><br>
        ๐ ${c.phone}<br>
        ${c.email ? "๐ง "+c.email+"<br>" : ""}
        ๐ฐ ${c.price} ุฌููู<br>
        ๐ ${c.start} โ ${c.end}<br>
        ๐ ุขุฎุฑ ุฒูุงุฑุฉ: ${c.lastVisit || "โ"}<br>
        ๐ ุงููุงุฏูุฉ: ${c.nextVisit || "โ"}<br>

        <a target="_blank"
           href="https://wa.me/201150402031?text=ุนููู:${c.name}">
           ๐ฌ ูุงุชุณุงุจ
        </a>

        <button onclick="deleteClient('${doc.id}')">๐ ุญุฐู</button>
      </div><hr>
    `;
  });
});

/* ุญุฐู ุนููู */
function deleteClient(id) {
  if (!confirm("โ๏ธ ุญุฐู ุงูุนููู ููุงุฆููุงุ")) return;
  db.collection("clients").doc(id).delete();
}
</script>

</body>
</html>
