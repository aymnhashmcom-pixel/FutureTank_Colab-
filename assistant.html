<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ â€” FutureTank</title>
<link rel="stylesheet" href="styles.css">
<style>
  .box{max-width:900px;margin:18px auto;background:#fff;padding:16px;border-radius:12px;box-shadow:0 8px 30px rgba(3,59,80,0.04)}
  #chat{height:420px;overflow:auto;padding:12px;border:1px solid #eef9ff;border-radius:8px;background:#fbfeff}
  .input{display:flex;gap:8px;margin-top:10px}
  input{flex:1;padding:12px;border-radius:8px;border:1px solid #dfeff8}
  button{padding:10px 14px;background:var(--accent);border:none;color:#fff;border-radius:8px;cursor:pointer}
  .msg{margin:8px 0}
  .me{color:#075;text-align:right}
  .bot{color:#025;text-align:left}
  .suggest{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
  .suggest button{background:#eef9ff;color:var(--accent-2);border-radius:8px;border:1px solid #d6f0ff;padding:6px 10px;cursor:pointer}
</style>
</head>
<body>
<div class="box">
  <h2>ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ â€” ÙÙŠÙˆØªØ´Ø± ØªØ§Ù†Ùƒ</h2>
  <div id="chat"></div>
  <div class="suggest" id="suggestions"></div>
  <div class="input">
    <input id="inputText" placeholder='Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ... Ù…Ø«Ù„: "Ù…Ø§ Ù‡ÙŠ Ø®Ø¯Ù…Ø§ØªÙƒÙ…ØŸ" Ø£Ùˆ "Ø£Ø±ÙŠØ¯ Ø­Ø¬Ø² ØªØ¹Ù‚ÙŠÙ…"'>
    <button onclick="send()">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>
</div>

<script>
const STORAGE_KEY='FutureTank_data_v1';

function loadData(){ try{const r=localStorage.getItem(STORAGE_KEY); if(r) return JSON.parse(r);}catch(e){} return null; }
function postUser(t){ const c=document.getElementById('chat'); c.innerHTML += `<div class="msg me"><b>Ø£Ù†Øª:</b> ${escapeHtml(t)}</div>`; c.scrollTop=c.scrollHeight; }
function postBot(html){ const c=document.getElementById('chat'); c.innerHTML += `<div class="msg bot"><b>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯:</b> ${html}</div>`; c.scrollTop=c.scrollHeight; trySpeak(stripTags(html)); }
function escapeHtml(s){ return s.replace(/[&<>"']/g, (m)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

function send(){ const el=document.getElementById('inputText'); const txt=el.value.trim(); if(!txt) return; postUser(txt); el.value=''; setTimeout(()=> respond(txt), 300); }

function stripTags(s){ return s.replace(/<[^>]*>?/gm, ''); }
function trySpeak(txt){
  try{
    const data = loadData();
    const speakEnabled = true;
    if(!speakEnabled) return;
    if('speechSynthesis' in window && txt){
      const u = new SpeechSynthesisUtterance(txt);
      const voices = window.speechSynthesis.getVoices();
      const ar = voices.find(v=>/arabic|ar-SA|ar_EG/i.test(v.lang) || /Arabic/i.test(v.name));
      if(ar) u.voice = ar;
      u.lang = 'ar-SA';
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(u);
    }
  }catch(e){}
}

function respond(text){
  const data = loadData() || {};
  const brand = data.brand && data.brand.name_ar ? data.brand.name_ar : 'ÙÙŠÙˆØªØ´Ø± ØªØ§Ù†Ùƒ';
  const phone = data.paymentNumber || '01150402031';
  const t = text.toLowerCase();

  // suggestions
  const suggs = ['Ù…Ø§ Ù‡ÙŠ Ø®Ø¯Ù…Ø§ØªÙƒÙ…ØŸ','ÙƒÙŠÙ Ø£Ø¯ÙØ¹ØŸ','Ø£Ø±ÙŠØ¯ Ø­Ø¬Ø² ØªØ¹Ù‚ÙŠÙ…','Ø£Ø±ÙŠØ¯ ÙÙ„ØªØ± Ù…Ù†Ø²Ù„ÙŠ'];
  const sugArea = document.getElementById('suggestions'); sugArea.innerHTML=''; suggs.forEach(s=>{ const b=document.createElement('button'); b.innerText=s; b.onclick=()=>{ postUser(s); respond(s); }; sugArea.appendChild(b); });

  if(/\b(Ø®Ø¯Ù…|Ø®Ø¯Ù…Ø§Øª|ØªÙˆØ±ÙŠØ¯|ØªØ±ÙƒÙŠØ¨|ØµÙŠØ§Ù†Ø©|ØªØ¹Ù‚ÙŠÙ…|ØªØ·Ù‡ÙŠØ±)\b/.test(t)){
    const services = (data.services||[]).map(s=>`â€¢ ${s.name}`).join('<br>');
    postBot(`Ù†Ù‚Ø¯Ù‘Ù… Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:<br>${services}<br><br>Ù„Ù„Ø­Ø¬Ø² Ø§ÙƒØªØ¨: "Ø§Ø­Ø¬Ø²" Ø«Ù… Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ Ø£Ùˆ Ø§Ø¶ØºØ· Ø²Ø± "Ø§Ø­Ø¬Ø² Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢Ù†" ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹.`);
    return;
  }

  if(/\b(Ù…Ù†ØªØ¬|ÙÙ„ØªØ±|Ø®Ø²Ø§Ù†|Ù…Ù†ØªØ¬Ø§Øª|Ø³Ø¹Ø±)\b/.test(t)){
    const products = (data.products||[]).map(p=>`â€¢ ${p.name} â€” ${p.price.toLocaleString()} Ø¬.Ù…`).join('<br>');
    postBot(`Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:<br>${products}<br><br>Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø© Ø§ÙƒØªØ¨: "Ø£Ø¶Ù" Ø«Ù… Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†".`);
    return;
  }

  if(/\b(Ø¯ÙØ¹|ÙƒØ§Ø´|Ø§ØªØµØ§Ù„Ø§Øª)\b/.test(t)){
    postBot(`Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… ${phone}. Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹ Ø£Ø±Ø³Ù„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø¥Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù….`);
    return;
  }

  if(/\b(Ø­Ø¬Ø²|Ø§Ø­Ø¬Ø²|Ø§Ø±ÙŠØ¯ Ø§Ø­Ø¬Ø²)\b/.test(t)){
    const svc = (data.services||[]).find(s => text.toLowerCase().includes(s.name.toLowerCase().split(' ')[0]));
    if(svc){
      postBot(`Ø­Ø³Ù†Ù‹Ø§ØŒ ÙŠØ¨Ø¯Ùˆ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯: ${svc.name}. Ø§Ù„Ø³Ø¹Ø±: ${svc.price} Ø¬.Ù…. Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ø¶ØºØ· "Ø§Ø­Ø¬Ø² Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢Ù†" Ø£Ùˆ Ø§ÙƒØªØ¨ "Ø£Ø¶Ù ${svc.name}".`);
    } else {
      postBot(`Ù„Ù„Ø­Ø¬Ø²ØŒ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø±ØºÙˆØ¨Ø© Ø£Ùˆ Ø§Ø¶ØºØ· "Ø§Ø­Ø¬Ø² Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢Ù†" ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹.`);
    }
    return;
  }

  if(/\b(Ù…Ù† Ø§Ù†ØªÙ…|Ù…Ù† Ù†Ø­Ù†|Ù…Ù† Ø§Ù†Øª|Ù…Ù† Ø£Ù†ØªÙ…)\b/.test(t)){
    postBot(`${brand} â€” Ù†Ù‚Ø¯Ù… Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…ÙŠØ§Ù‡: ØªÙˆØ±ÙŠØ¯/ØªØ±ÙƒÙŠØ¨/ØµÙŠØ§Ù†Ø©/ØªØ¹Ù‚ÙŠÙ… Ø®Ø²Ø§Ù†Ø§Øª ÙˆÙÙ„Ø§ØªØ±. Ø§Ù„Ø´Ø¹Ø§Ø±: "${(data.brand&&data.brand.slogan)||'Ù†Ù‚Ø§Ø¡ Ø§Ù„Ù…Ø§Ø¡ Ù‡Ùˆ Ù‡Ø¯ÙÙ†Ø§'}".`);
    return;
  }

  if(/\b(ÙØ§ØªÙˆØ±Ø©|invoice|ÙØ§ØªÙˆØ±Ø©)\b/.test(t)){
    postBot(`ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø¹Ø¨Ø± ØµÙØ­Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¢Ù†ØŸ`);
    return;
  }

  postBot(`Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© â€” Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù†: Ø§Ù„Ø®Ø¯Ù…Ø§ØªØŒ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø§Ù„Ø­Ø¬Ø²ØŒ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø£Ùˆ Ø§Ù„ÙÙˆØ§ØªÙŠØ±. Ù…Ø«Ø§Ù„: "Ù…Ø§ Ù‡ÙŠ Ø®Ø¯Ù…Ø§ØªÙƒÙ…ØŸ" Ø£Ùˆ "ÙƒÙŠÙ Ø£Ø¯ÙØ¹ØŸ"`);
}
</script>
</body>
</html>